/*
# ===============================================================================
#                      {{TASK.PROJECT.COMPANY}}
#
# ===============================================================================
# ===============================================================================
# Script Name         : {{TASK.ENV_CONFIG.RFC}}_ENV_CONFIG.ddl
# Purpose             :	Access role for SRCI EXS 
# Author              : {{TASK.PROJECT.TEAM}}
# File Type           : DDL
# Creation Date       : {{TASK.DATE}}
# Pending 		      :
# Version             : Initial
# -------------------------------------------------------------------------------
# Change History :
# Ver  | Date        	|  	Modified By           |  Change Description
# -------------------------------------------------------------------------------
# 1.0   {{TASK.DATE}}      	{{TASK.PROJECT.TEAM}}           INITIAL
#
# ===============================================================================
*/


DEL FROM ENV_CONFIG.ENV_CONFIG WHERE VERSION='{{TASK.ENV_CONFIG.RFC}}';

-- Version

EXEC ENV_CONFIG.EnvAddVersion('{{TASK.ENV_CONFIG.RFC}}','{{TASK.NAME}}');

-- Databases

EXEC ENV_CONFIG.EnvAddDatabase(VERSION='{{TASK.ENV_CONFIG.RFC}}',DB_SUFFIX='ACC_{{TASK.ENV_CONFIG.ACC_NAME}}',OWNER_GROUP='ACC',RATIO=0,COMMENTS='Group for {{TASK.ENV_CONFIG.ACC_DESC}}');
EXEC ENV_CONFIG.EnvAddDatabase(VERSION='{{TASK.ENV_CONFIG.RFC}}',DB_SUFFIX='T_ACC_{{TASK.ENV_CONFIG.ACC_NAME}}',OWNER_GROUP='ACC_{{TASK.ENV_CONFIG.ACC_NAME}}',RATIO=0,COMMENTS='Table Database for {{TASK.ENV_CONFIG.ACC_DESC}}');
EXEC ENV_CONFIG.EnvAddDatabase(VERSION='{{TASK.ENV_CONFIG.RFC}}',DB_SUFFIX='V_ACC_{{TASK.ENV_CONFIG.ACC_NAME}}',OWNER_GROUP='ACC_{{TASK.ENV_CONFIG.ACC_NAME}}',RATIO=0,COMMENTS='Write View Database for {{TASK.ENV_CONFIG.ACC_DESC}}');
EXEC ENV_CONFIG.EnvAddDatabase(VERSION='{{TASK.ENV_CONFIG.RFC}}',DB_SUFFIX='A_ACC_{{TASK.ENV_CONFIG.ACC_NAME}}',OWNER_GROUP='ACC_{{TASK.ENV_CONFIG.ACC_NAME}}',RATIO=0,COMMENTS='Read View Database for {{TASK.ENV_CONFIG.ACC_DESC}}');
EXEC ENV_CONFIG.EnvAddDatabase(VERSION='{{TASK.ENV_CONFIG.RFC}}',DB_SUFFIX='C_ACC_{{TASK.ENV_CONFIG.ACC_NAME}}',OWNER_GROUP='ACC_{{TASK.ENV_CONFIG.ACC_NAME}}',RATIO=0,COMMENTS='Current View Database for {{TASK.ENV_CONFIG.ACC_DESC}}');
EXEC ENV_CONFIG.EnvAddDatabase(VERSION='{{TASK.ENV_CONFIG.RFC}}',DB_SUFFIX='T_TMP_ACC_{{TASK.ENV_CONFIG.ACC_NAME}}',OWNER_GROUP='TMP',RATIO=0,COMMENTS='Temporary Working table database for {{TASK.ENV_CONFIG.ACC_DESC}}');

-- Intra Database Permissions


EXEC ENV_CONFIG.EnvAddIntraDB(VERSION='{{TASK.ENV_CONFIG.RFC}}',DB_SUFFIX='T_ACC_{{TASK.ENV_CONFIG.ACC_NAME}}',GRANTS='SELECT',GRANT_TO='A_ACC_{{TASK.ENV_CONFIG.ACC_NAME}}');
EXEC ENV_CONFIG.EnvAddIntraDB(VERSION='{{TASK.ENV_CONFIG.RFC}}',DB_SUFFIX='T_ACC_{{TASK.ENV_CONFIG.ACC_NAME}}',GRANTS='SELECT',GRANT_TO='C_ACC_{{TASK.ENV_CONFIG.ACC_NAME}}');
EXEC ENV_CONFIG.EnvAddIntraDB(VERSION='{{TASK.ENV_CONFIG.RFC}}',DB_SUFFIX='T_ACC_{{TASK.ENV_CONFIG.ACC_NAME}}',GRANTS='SELECT,UPDATE,INSERT,DELETE,STATISTICS',GRANT_TO='V_ACC_{{TASK.ENV_CONFIG.ACC_NAME}}');

--- Roles

EXECUTE ENV_CONFIG.EnvAddRole(VERSION='{{TASK.ENV_CONFIG.RFC}}',GRANT_TO='BATCH_ACC_{{TASK.ENV_CONFIG.ACC_NAME}}',COMMENTS='BATCH Role of {{TASK.ENV_CONFIG.ACC_DESC}}');
EXECUTE ENV_CONFIG.EnvAddRole(VERSION='{{TASK.ENV_CONFIG.RFC}}',GRANT_TO='ACCESS_ACC_{{TASK.ENV_CONFIG.ACC_NAME}}',COMMENTS='ACCESS Role of {{TASK.ENV_CONFIG.ACC_DESC}}');
EXECUTE ENV_CONFIG.EnvAddRole(VERSION='{{TASK.ENV_CONFIG.RFC}}',GRANT_TO='READ_ACC_{{TASK.ENV_CONFIG.ACC_NAME}}',COMMENTS='READ Role of {{TASK.ENV_CONFIG.ACC_DESC}}');

-- Access

-- Access Role
EXECUTE ENV_CONFIG.EnvAddRoleRights(VERSION='{{TASK.ENV_CONFIG.RFC}}',DB_SUFFIX='A_ACC_{{TASK.ENV_CONFIG.ACC_NAME}}',GRANTS='SELECT,SHOW',GRANT_TO='ACCESS_ACC_{{TASK.ENV_CONFIG.ACC_NAME}}'); 
EXECUTE ENV_CONFIG.EnvAddRoleRights(VERSION='{{TASK.ENV_CONFIG.RFC}}',DB_SUFFIX='C_ACC_{{TASK.ENV_CONFIG.ACC_NAME}}',GRANTS='SELECT,SHOW',GRANT_TO='ACCESS_ACC_{{TASK.ENV_CONFIG.ACC_NAME}}'); 

-- Read Role
EXECUTE ENV_CONFIG.EnvAddRoleRights(VERSION='{{TASK.ENV_CONFIG.RFC}}',DB_SUFFIX='A_ACC_{{TASK.ENV_CONFIG.ACC_NAME}}',GRANTS='SELECT,SHOW',GRANT_TO='READ_ACC_{{TASK.ENV_CONFIG.ACC_NAME}}'); 
EXECUTE ENV_CONFIG.EnvAddRoleRights(VERSION='{{TASK.ENV_CONFIG.RFC}}',DB_SUFFIX='C_ACC_{{TASK.ENV_CONFIG.ACC_NAME}}',GRANTS='SELECT,SHOW',GRANT_TO='READ_ACC_{{TASK.ENV_CONFIG.ACC_NAME}}'); 
EXECUTE ENV_CONFIG.EnvAddRoleRights(VERSION='{{TASK.ENV_CONFIG.RFC}}',DB_SUFFIX='V_ACC_{{TASK.ENV_CONFIG.ACC_NAME}}',GRANTS='SELECT,SHOW',GRANT_TO='READ_ACC_{{TASK.ENV_CONFIG.ACC_NAME}}'); 
EXECUTE ENV_CONFIG.EnvAddRoleRights(VERSION='{{TASK.ENV_CONFIG.RFC}}',DB_SUFFIX='T_ACC_{{TASK.ENV_CONFIG.ACC_NAME}}',GRANTS='SELECT,SHOW',GRANT_TO='READ_ACC_{{TASK.ENV_CONFIG.ACC_NAME}}');  

-- Batch Role
EXECUTE ENV_CONFIG.EnvAddRoleRights(VERSION='{{TASK.ENV_CONFIG.RFC}}',DB_SUFFIX='A_ACC_{{TASK.ENV_CONFIG.ACC_NAME}}',GRANTS='SELECT,SHOW',GRANT_TO='BATCH_ACC_{{TASK.ENV_CONFIG.ACC_NAME}}'); 
EXECUTE ENV_CONFIG.EnvAddRoleRights(VERSION='{{TASK.ENV_CONFIG.RFC}}',DB_SUFFIX='C_ACC_{{TASK.ENV_CONFIG.ACC_NAME}}',GRANTS='SELECT,SHOW',GRANT_TO='BATCH_ACC_{{TASK.ENV_CONFIG.ACC_NAME}}'); 
EXECUTE ENV_CONFIG.EnvAddRoleRights(VERSION='{{TASK.ENV_CONFIG.RFC}}',DB_SUFFIX='V_ACC_{{TASK.ENV_CONFIG.ACC_NAME}}',GRANTS='SELECT,SHOW',GRANT_TO='BATCH_ACC_{{TASK.ENV_CONFIG.ACC_NAME}}'); 
EXECUTE ENV_CONFIG.EnvAddRoleRights(VERSION='{{TASK.ENV_CONFIG.RFC}}',DB_SUFFIX='T_ACC_{{TASK.ENV_CONFIG.ACC_NAME}}',GRANTS='SELECT,UPDATE,INSERT,DELETE,STATISTICS,SHOW',GRANT_TO='BATCH_ACC_{{TASK.ENV_CONFIG.ACC_NAME}}');  
EXECUTE ENV_CONFIG.EnvAddRoleRights(VERSION='{{TASK.ENV_CONFIG.RFC}}',DB_SUFFIX='T_TMP_ACC_{{TASK.ENV_CONFIG.ACC_NAME}}',GRANTS='SELECT,UPDATE,INSERT,DELETE,STATISTICS,SHOW',GRANT_TO='BATCH_ACC_{{TASK.ENV_CONFIG.ACC_NAME}}');  
EXECUTE ENV_CONFIG.EnvAddRoleRights(VERSION='{{TASK.ENV_CONFIG.RFC}}',DB_SUFFIX='A_IDW',GRANTS='SELECT,SHOW',GRANT_TO='BATCH_ACC_{{TASK.ENV_CONFIG.ACC_NAME}}');
EXECUTE ENV_CONFIG.EnvAddRoleRights(VERSION='{{TASK.ENV_CONFIG.RFC}}',DB_SUFFIX='C_IDW',GRANTS='SELECT,SHOW',GRANT_TO='BATCH_ACC_{{TASK.ENV_CONFIG.ACC_NAME}}');
EXECUTE ENV_CONFIG.EnvAddRoleRights(VERSION='{{TASK.ENV_CONFIG.RFC}}',DB_SUFFIX='A_SRCI_RMS',GRANTS='SELECT,SHOW',GRANT_TO='BATCH_ACC_{{TASK.ENV_CONFIG.ACC_NAME}}');
EXECUTE ENV_CONFIG.EnvAddRoleRights(VERSION='{{TASK.ENV_CONFIG.RFC}}',DB_SUFFIX='C_SRCI_RMS',GRANTS='SELECT,SHOW',GRANT_TO='BATCH_ACC_{{TASK.ENV_CONFIG.ACC_NAME}}');

EXECUTE ENV_CONFIG.EnvAddRoleRights(VERSION='{{TASK.ENV_CONFIG.RFC}}',DB_SUFFIX='V_MET',GRANTS='SELECT,UPDATE,INSERT,DELETE,STATISTICS,SHOW',GRANT_TO='BATCH_ACC_{{TASK.ENV_CONFIG.ACC_NAME}}');  
EXECUTE ENV_CONFIG.EnvAddRoleRights(VERSION='{{TASK.ENV_CONFIG.RFC}}',DB_SUFFIX='A_MET',GRANTS='SELECT,SHOW',GRANT_TO='BATCH_ACC_{{TASK.ENV_CONFIG.ACC_NAME}}');  
EXECUTE ENV_CONFIG.EnvAddRoleRights(VERSION='{{TASK.ENV_CONFIG.RFC}}',DB_SUFFIX='T_MET',GRANTS='STATISTICS,SHOW',GRANT_TO='BATCH_ACC_{{TASK.ENV_CONFIG.ACC_NAME}}');  





/* Users */
EXECUTE ENV_CONFIG.EnvAddUser(VERSION='{{TASK.ENV_CONFIG.RFC}}',DB_SUFFIX='U_ACC_{{TASK.ENV_CONFIG.ACC_NAME}}',COMMENTS='{{TASK.ENV_CONFIG.ACC_DESC}} Batch User');

/* Role to User */

EXECUTE ENV_CONFIG.EnvAddUserRole(VERSION='{{TASK.ENV_CONFIG.RFC}}',DB_SUFFIX='U_ACC_{{TASK.ENV_CONFIG.ACC_NAME}}',GRANT_TO='BATCH_ACC_{{TASK.ENV_CONFIG.ACC_NAME}}',COMMENTS='');

-- Generate default roles
EXECUTE ENV_CONFIG.EnvAddAutoRoles(VERSION='{{TASK.ENV_CONFIG.RFC}}',AUTOROLE='DEFAULT');

